<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Custom T-Shirt Designer</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
body {
    margin: 0;
    font-family: 'Roboto', sans-serif;
    background: #f4f6f8;
    text-align: center;
}

h1 {
    margin-top: 30px;
    color: #333;
    font-weight: 700;
}

#designer {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 30px;
    padding: 20px;
}

#controls {
    background: #fff;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    max-width: 300px;
    width: 100%;
}

#controls label {
    display: block;
    font-weight: 500;
    margin-top: 15px;
    margin-bottom: 5px;
    color: #555;
}

#controls input[type="text"],
#controls input[type="number"],
#controls input[type="color"],
#controls button {
    width: 100%;
    margin-bottom: 10px;
    padding: 10px 12px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 14px;
    box-sizing: border-box;
}

#controls button {
    background: #2196F3;
    color: #fff;
    border: none;
    cursor: pointer;
    transition: background 0.2s ease;
    font-weight: 500;
}

#controls button:hover {
    background: #1976D2;
}

#canvasWrap {
    position: relative;
    width: 400px;
    height: 450px;
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    justify-content: center;
}

#shirtCanvas {
    cursor: pointer;
    border-radius: 15px;
    background: transparent;
}
</style>
</head>
<body>

<h1>Custom T-Shirt Designer</h1>

<div id="designer">
  <div id="controls">
    <label>Shirt Color:</label>
    <input type="color" id="shirtColor" value="#ffffff">

    <label>Add Text:</label>
    <input type="text" id="userText" placeholder="Enter text">
    <input type="number" id="textSize" value="24" placeholder="Font size">
    <input type="color" id="textColor" value="#000000">
    <button onclick="addText()">Add Text</button>

    <label>Upload Image:</label>
    <input type="file" id="uploadImage" accept="image/*">

    <button onclick="bringForward()">Bring Forward</button>
    <button onclick="sendBackward()">Send Backward</button>
    <button onclick="downloadImage()">Download Design</button>
  </div>

  <div id="canvasWrap">
    <canvas id="shirtCanvas" width="350" height="400"></canvas>
  </div>
</div>

<script>
const canvas = document.getElementById("shirtCanvas");
const ctx = canvas.getContext("2d");

let objects = [];
let selectedIndex = null;
let dragIndex = null;
let offsetX = 0, offsetY = 0;

const shirtImg = new Image();
shirtImg.crossOrigin = "anonymous";
shirtImg.src = "images/tshirt-3d.png"; // your 3D T-shirt PNG here
shirtImg.onload = drawShirt;

function drawShirt(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Shirt color
  ctx.fillStyle = document.getElementById("shirtColor").value;
  ctx.fillRect(50,50,250,300);

  // Objects
  objects.forEach((obj,i)=>{
    if(obj.type==='image'){
      ctx.drawImage(obj.img,obj.x,obj.y,obj.width,obj.height);
    } else if(obj.type==='text'){
      ctx.fillStyle=obj.color;
      ctx.font=obj.size+'px Arial';
      ctx.fillText(obj.text,obj.x,obj.y);
    }

    if(i===selectedIndex){
      ctx.strokeStyle="#2196F3";
      ctx.setLineDash([5,5]);
      if(obj.type==='text'){
        const w=ctx.measureText(obj.text).width;
        const h=obj.size;
        ctx.strokeRect(obj.x-2,obj.y-h-2,w+4,h+4);
      } else if(obj.type==='image'){
        ctx.strokeRect(obj.x-2,obj.y-2,obj.width+4,obj.height+4);
      }
      ctx.setLineDash([]);
    }
  });

  ctx.drawImage(shirtImg,0,0,canvas.width,canvas.height);
}

function addText(){
  const txt=document.getElementById("userText").value.trim();
  if(!txt) return;
  const size=parseInt(document.getElementById("textSize").value)||24;
  const color=document.getElementById("textColor").value;
  objects.push({type:'text',text:txt,x:100,y:100,size:size,color:color});
  drawShirt();
}

document.getElementById("uploadImage").addEventListener("change",e=>{
  const file=e.target.files[0];
  if(!file) return;
  const img=new Image();
  img.onload=function(){
    objects.push({type:'image',img:img,x:50,y:80,width:150,height:150});
    drawShirt();
  };
  img.src=URL.createObjectURL(file);
});

canvas.addEventListener("mousedown",e=>{
  const mx=e.offsetX,my=e.offsetY;
  dragIndex=null;
  for(let i=objects.length-1;i>=0;i--){
    const obj=objects[i];
    if(obj.type==='text'){
      ctx.font=obj.size+'px Arial';
      const w=ctx.measureText(obj.text).width;
      const h=obj.size;
      if(mx>obj.x && mx<obj.x+w && my>obj.y-h && my<obj.y){ dragIndex=i; offsetX=mx-obj.x; offsetY=my-obj.y; break; }
    } else if(obj.type==='image'){
      if(mx>obj.x && mx<obj.x+obj.width && my>obj.y && my<obj.y+obj.height){ dragIndex=i; offsetX=mx-obj.x; offsetY=my-obj.y; break; }
    }
  }
  selectedIndex=dragIndex;
});

canvas.addEventListener("mousemove",e=>{
  if(dragIndex!==null){
    const obj=objects[dragIndex];
    obj.x=e.offsetX-offsetX;
    obj.y=e.offsetY-offsetY;
    drawShirt();
  }
});

canvas.addEventListener("mouseup",()=>dragIndex=null);

canvas.addEventListener("wheel",e=>{
  if(selectedIndex!==null){
    e.preventDefault();
    const obj=objects[selectedIndex];
    const factor=e.deltaY>0?0.95:1.05;
    if(obj.type==='text'){ obj.size*=factor; if(obj.size<5)obj.size=5; }
    if(obj.type==='image'){ obj.width*=factor; obj.height*=factor; }
    drawShirt();
  }
});

function bringForward(){ if(selectedIndex!==null && selectedIndex<objects.length-1){ const tmp=objects[selectedIndex]; objects[selectedIndex]=objects[selectedIndex+1]; objects[selectedIndex+1]=tmp; selectedIndex++; drawShirt(); } }
function sendBackward(){ if(selectedIndex!==null && selectedIndex>0){ const tmp=objects[selectedIndex]; objects[selectedIndex]=objects[selectedIndex-1]; objects[selectedIndex-1]=tmp; selectedIndex--; drawShirt(); } }

document.getElementById("shirtColor").addEventListener("input",drawShirt);

function downloadImage(){ const link=document.createElement("a"); link.download='tshirt-design.png'; link.href=canvas.toDataURL(); link.click(); }
</script>

</body>
</html>
